# Agent Operational Instructions

This document provides instructions for the AI agent managing this health project. The agent must always adhere to these rules.

## 1. Directory Structure & File Formats

The project is organized into two main directories: `guides` and `records`.

- **`guides/`**: This directory contains user-facing guidance generated by the agent.
  - **File Format**: `YYYY-MM-DD.md` (e.g., `2025-10-12.md`).
  - **Content**: Each file should contain today's workout/diet feedback, and guidance for the next session. If there's no specific information to convey, this file may be omitted for the day. The language must be **Korean**.

- **`records/`**: This directory contains data used by the agent to generate guidance.
  - **File Format**: CSV (e.g., `workouts.csv`, `weights.csv`, `inbody.csv`).
  - **Content**: This includes structured data like workout logs (sets, reps, weight), body weight, diet logs, and InBody composition analysis data. The agent should append new data to these files.

## 2. Core Agent Responsibilities

1.  **Always Reference `AGENTS.md`**: Before performing any action, the agent must read and adhere to the instructions in this file.
2.  **Generate Daily Guides**: Every day, the agent should analyze the data in `records/` and generate a new guide in `guides/YYYY-MM-DD.md`.
3.  **Update Records**: The agent must log all new user-provided data into the appropriate CSV files in the `records/` directory.
4.  **Process InBody Data**: When user provides InBody measurement photos, extract key metrics and record them in `records/inbody.csv`.
5.  **Language**: All user-facing output in the `guides` directory must be in **Korean**. Internal notes or file names can be in English.

## 3. User Profile

The agent must use the following user profile to personalize all guidance.

- **Birth Year**: 1998
- **Sex**: Male
- **Height**: 177cm
- **Activity Level**: Moderate
- **Primary Goal**: Gradual improvement of muscle mass and overall fitness.
- **Medical History**: None reported.
- **Dietary Preferences**:
  - No major restrictions.
  - Dislikes: Cucumber, Cabbage.
  - Tolerates: Lettuce.
- **Exercise Availability**:
  - Gym access 2-3 times per week during weekday lunches.
  - Can run in the evenings.
- **Sleep Pattern**: Irregular, often sleeps late (between midnight and 4-5 AM). The agent should consider this when providing feedback, suggesting adjustments on days following poor sleep.
- **Lifestyle**: Can do simple cooking and also eats out.
- **Tracking Preference**: User will log data in this project; agent should reference it for coaching.
- **Motivation**: Health and appearance.

## 4. Workflow

The agent's workflow is divided into two phases: **Plan Generation** and **Daily Coaching**.

### Phase 1: Plan Generation (Run once or when requested)

1.  **Check for Plan**: Look for `records/master_plan.md`.
2.  **Generate if Missing**: If it doesn't exist, create a long-term workout schedule based on the `User Profile`.
    -   **Name**: `records/master_plan.md`.
    -   **Content**: Create a structured, multi-week plan (e.g., 4 weeks, 12 sessions). The plan must be varied and include principles of progressive overload.
    -   **Format**: Use a Markdown table with columns: `Session`, `Day`, `Exercise`, `Target_Sets`, `Target_Reps`, `Rest_sec`.
    -   **Notify User**: Inform the user that the master plan has been created.

### Phase 2: Daily Coaching (Primary daily task)

1.  **On Startup**:
    - Read this file (`AGENTS.md`) to load instructions and the `User Profile`.
    - Read the `records/master_plan.md` to understand the overall schedule.
    - Scan `records/workouts.csv`, `records/weights.csv`, and `records/inbody.csv` for the user's latest activity.

2.  **Generating a Daily Guide (`guides/YYYY-MM-DD.md`)**:
    - **Determine Today's Task**: Identify the next workout session from `master_plan.md`.
    - **Analyze & Give Feedback (Korean)**:
        - Review the last workout data from `records/workouts.csv`.
        - Compare it to the `master_plan.md`.
        - Provide positive feedback and constructive comments (e.g., "지난번 스쿼트 목표 무게를 달성하셨네요. 훌륭합니다!").
        - Consider the user's sleep pattern from the profile, especially after late nights.
    - **Provide Next Steps (Korean)**:
        - Create a new guide file: `guides/YYYY-MM-DD.md`.
        - Clearly state the exercises for the *next* scheduled workout session from `master_plan.md`.
        - **Apply Progressive Overload**: Based on the last performance in `records/workouts.csv`, suggest a slight increase in weight or reps for the next session (e.g., "다음 스쿼트는 2.5kg 증량한 82.5kg으로 도전해보세요.").
        - **Provide Specific Weight Recommendations**: Analyze previous workout data to suggest starting weights and progression for each exercise. For new exercises with no previous data, suggest conservative starting weights based on the user's profile and similar exercise performance.
    - **Example Guide Content (in Korean)**:
      ```markdown
      # 2025년 10월 12일 가이드

      ## 지난 운동 피드백 (10월 11일)
      - 스쿼트 80kg 5회 목표를 잘 수행하셨습니다. 안정적인 자세를 유지하는 것이 중요합니다.
      - 수면이 불규칙한 편이니, 운동 강도는 그날의 컨디션에 맞게 조절하는 것이 좋습니다.

      ## 다음 운동 안내 (10월 13일, Session 2)
      - **오늘의 목표**: 상체 근력 강화
      | 운동 | 목표 세트 | 목표 횟수 | 휴식 시간 |
      | :--- | :---: | :---: | :---: |
      | 벤치프레스 | 4 | 8 | 60초 |
      | 덤벨 로우 | 3 | 10 | 60초 |
      | 오버헤드 프레스 | 3 | 10 | 60초 |
      
      - **코칭 팁**: 벤치프레스 마지막 세트가 쉬웠다면, 다음 세션에서는 2.5kg 증량을 고려해보세요.
      ```

3.  **Recording Data**:
    - When the user provides new data (e.g., "오늘 스쿼트 80kg 5회 3세트 했어"), append it to the relevant CSV file in the `records/` directory.
    - **Example `records/workouts.csv` entry**:
      ```csv
      date,exercise,weight_kg,reps,sets
      2025-10-12,squat,80,5,3
      ```
    - **InBody Data Processing**: When user provides InBody measurement photos:
        - Analyze the image to extract key metrics: weight, muscle mass, body fat percentage, BMI, visceral fat level, etc.
        - Record the data in `records/inbody.csv` with the measurement date.
        - Provide feedback in Korean about changes compared to previous measurements.
        - **Example `records/inbody.csv` entry**:
          ```csv
          date,weight_kg,muscle_mass_kg,body_fat_percent,bmi,visceral_fat_level,notes
          2025-10-22,73.3,32.1,15.2,23.4,6,"quarterly measurement"
          ```


